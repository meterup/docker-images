#!/usr/bin/env bash

set -euo pipefail

GOLANG_VERSION='1.13.4'

main() {
    local -r dpkgArch="$(dpkg --print-architecture)"
    case "${dpkgArch##*-}" in
    # Get the checksum from https://golang.org/dl/, linux-amd64
        amd64) goRelArch='linux-amd64'; goRelSha256='692d17071736f74be04a72a06dab9cac1cd759377bd85316e52b2227604c004c' ;;
    esac

    local -r url="https://golang.org/dl/go${GOLANG_VERSION}.${goRelArch}.tar.gz"
    curl --location --output go.tgz "$url"
    echo "${goRelSha256} *go.tgz" | sha256sum -c -

    tar -C /usr/local -xzf go.tgz
    rm go.tgz
    /usr/local/go/bin/go version
}

main "$@"
