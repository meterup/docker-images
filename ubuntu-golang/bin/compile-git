#!/usr/bin/env bash

set -euo pipefail

VERSION='2.24.0'
BINARY="v${VERSION}.zip"
DIRECTORY="git-${VERSION}"

main() {
    pushd /tmp 2>/dev/null
        if [[ ! -f "$BINARY" ]]; then
            curl --remote-name --silent --location "https://github.com/git/git/archive/${BINARY}"
        fi
        unzip -q "$BINARY"
        pushd "${DIRECTORY}" 2>/dev/null
            # https://git-scm.com/book/en/v2/Getting-Started-Installing-Git
            make configure
            ./configure --prefix=/usr/local --with-expat=no --with-tcltk=no
            make all
            make install
        popd
        rm -rf "${BINARY}" "${DIRECTORY}"
        ls -lah
    popd
}

main "$@"
